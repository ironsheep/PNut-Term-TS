'' Test PLOT window common commands and behaviors
'' This tests that base class changes didn't break anything
CON _clkfreq = 100_000_000

PUB go() | i

  ' Test 1: Basic PLOT with all common commands
  debug(`PLOT MyPlot SIZE 400 300 COLOR BLACK CYAN)
  debug(`MyPlot TEXT 10 10 'Testing Common Commands'`)

  ' Draw something to have content to clear
  repeat i from 0 to 100 step 10
    debug(`MyPlot DOT `(i) `(i) DOTSIZE 3 RED 15)

  waitms(1000)

  ' Test CLEAR command - should clear the display
  debug(`MyPlot CLEAR)
  debug(`MyPlot TEXT 10 30 'After CLEAR command'`)

  waitms(1000)

  ' Test UPDATE command (in deferred mode)
  debug(`PLOT Deferred SIZE 200 200 UPDATE COLOR BLACK WHITE)
  debug(`Deferred TEXT 10 10 'Deferred mode'`)
  repeat i from 0 to 50
    debug(`Deferred DOT `(i*2) `(i*2))
  debug(`Deferred UPDATE)  ' Force update

  waitms(1000)

  ' Test SAVE command
  debug(`MyPlot SAVE 'test-plot.bmp'`)
  debug(`MyPlot TEXT 10 50 'Saved to test-plot.bmp'`)

  waitms(1000)

  ' Test SAVE WINDOW command
  debug(`MyPlot SAVE WINDOW 'test-plot-window.bmp'`)
  debug(`MyPlot TEXT 10 70 'Saved window to test-plot-window.bmp'`)

  repeat
    waitms(100)

'' Test 2: PC_KEY and PC_MOUSE commands
PUB test_input() | i

  debug(`PLOT Interactive SIZE 400 300 COLOR BLACK GREEN)
  debug(`Interactive TEXT 10 10 'Test PC_KEY and PC_MOUSE'`)

  ' Enable keyboard input
  debug(`Interactive PC_KEY)

  repeat
    ' The P2 would receive keyboard data here
    waitms(100)

'' Test 3: CLOSE command
PUB test_close() | i

  debug(`PLOT TempWindow SIZE 200 200 COLOR BLACK YELLOW)
  debug(`TempWindow TEXT 10 10 'This window will close in 3 seconds'`)

  repeat i from 3 to 1
    debug(`TempWindow TEXT 10 `(30 + i*20) 'Closing in `(i)...'`)
    waitms(1000)

  ' Test CLOSE command
  debug(`TempWindow CLOSE)

  debug(`PLOT StillHere SIZE 200 200 COLOR BLACK GREEN)
  debug(`StillHere TEXT 10 10 'Other window closed'`)

  repeat
    waitms(100)

'' Test 4: Multiple windows with common commands
PUB test_multiple() | i

  ' Create multiple PLOT windows
  debug(`PLOT Plot1 SIZE 200 200 POS 100 100 COLOR BLACK RED)
  debug(`PLOT Plot2 SIZE 200 200 POS 350 100 COLOR BLACK BLUE)
  debug(`PLOT Plot3 SIZE 200 200 POS 600 100 COLOR BLACK GREEN)

  ' Draw in each
  debug(`Plot1 TEXT 10 10 'Window 1'`)
  debug(`Plot2 TEXT 10 10 'Window 2'`)
  debug(`Plot3 TEXT 10 10 'Window 3'`)

  waitms(1000)

  ' Clear them one by one
  debug(`Plot1 CLEAR)
  debug(`Plot1 TEXT 10 10 'Cleared 1'`)
  waitms(500)

  debug(`Plot2 CLEAR)
  debug(`Plot2 TEXT 10 10 'Cleared 2'`)
  waitms(500)

  debug(`Plot3 CLEAR)
  debug(`Plot3 TEXT 10 10 'Cleared 3'`)

  repeat
    waitms(100)